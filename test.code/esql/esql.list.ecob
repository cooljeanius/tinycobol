 IDENTIFICATION DIVISION.
 PROGRAM-ID. ESQL.
 ENVIRONMENT DIVISION.
 CONFIGURATION SECTION.
* INPUT-OUTPUT SECTION.
 DATA DIVISION.
 FILE SECTION.

 WORKING-STORAGE SECTION.
    EXEC SQL
	INCLUDE SQLCA
    END-EXEC 
    77 COUNTER	PIC 	S9.
    01 WHERE-ERROR	PIC	X(72).
   EXEC SQL BEGIN DECLARE SECTION END-EXEC
    01 CITY BASED ON FRIEND.CITY.
   EXEC SQL END DECLARE SECTION END-EXEC
 
 PROCEDURE DIVISION.
 MAIN.
  	DISPLAY " ".
  	DISPLAY " ".
  	DISPLAY " DEMO ESQL PROGRAM ".
		EXEC SQL
			CONNECT TO 'demo.gdb'
		END-EXEC
		DISPLAY "DATABASE OPEN RETURNS CODE: " SQLCODE.
		EXEC SQL
			 DECLARE CITYLIST CURSOR FOR
				SELECT CITY FROM FRIEND
		END-EXEC
		DISPLAY "DECLARE CURSOR RETURNS CODE: " SQLCODE.
		EXEC SQL
			OPEN CITYLIST
		END-EXEC
		DISPLAY "OPEN CURSOR RETURNS CODE: " SQLCODE.
		EXEC SQL
			FETCH CITYLIST INTO :CITY
		END-EXEC
		DISPLAY "FETCH CURSOR RETURNS CODE: " SQLCODE.
		PERFORM DISPLAY-IT
		UNTIL SQLCODE NOT = ZERO.
		EXEC SQL
			CLOSE CITYLIST
		END-EXEC
		DISPLAY "CLOSE CURSOR RETURNS CODE: " SQLCODE.

		EXEC SQL
			DISCONNECT ALL
		END-EXEC.
		DISPLAY "DATABASE CLOSE RETURNS CODE: " SQLCODE.
  STOP RUN.
 DISPLAY-IT.
		DISPLAY "CITY: " CITY.
		EXEC SQL
			FETCH CITYLIST INTO :CITY
		END-EXEC
		DISPLAY "FETCH CURSOR RETURNS CODE: " SQLCODE.
